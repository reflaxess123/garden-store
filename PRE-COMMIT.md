# Pre-commit хуки

В проекте настроены pre-commit хуки для автоматической проверки кода перед коммитом.

## Что проверяется

### Фронтенд (Next.js/TypeScript)

- **ESLint** - проверка стиля кода и потенциальных ошибок
- **TypeScript** - проверка типов

### Бэкенд (Python/FastAPI)

- **Ruff Lint** - проверка стиля кода и потенциальных ошибок
- **Ruff Format** - автоматическое форматирование кода

### Общие проверки

- Удаление trailing whitespace
- Добавление переноса строки в конце файлов
- Проверка YAML и JSON файлов
- Проверка merge конфликтов

## Установка

Хуки уже установлены в репозиторий. Если нужно переустановить:

```bash
make install-hooks
# или
pre-commit install
```

## Использование

### Автоматически при коммите

Хуки запускаются автоматически при каждом `git commit`. Если проверки не прошли, коммит будет отклонен.

### Ручной запуск

```bash
# Запустить все проверки
make lint

# Запустить только фронтенд
make lint-front

# Запустить только бэкенд
make lint-back

# Проверить типы TypeScript
make type-check

# Отформатировать код бэкенда
make format-back

# Протестировать хуки на всех файлах
make test-hooks

# Обновить версии хуков
make update-hooks

# Показать все доступные команды
make help
```

### Прямые команды pre-commit

```bash
# Запустить на всех файлах
pre-commit run --all-files

# Запустить только на staged файлах
pre-commit run

# Запустить конкретный хук
pre-commit run frontend-lint
pre-commit run backend-ruff-check

# Пропустить хуки при коммите (не рекомендуется)
git commit --no-verify
```

## Настройка

Конфигурация находится в файле `.pre-commit-config.yaml`.

Если нужно изменить правила линтинга:

- **Фронтенд**: `front/eslint.config.mjs`
- **Бэкенд**: `back/pyproject.toml` (секции `[tool.ruff]` и `[tool.ruff.lint]`)

## Решение проблем

### Хуки не запускаются

```bash
make install-hooks
```

### Ошибки форматирования

Большинство ошибок форматирования исправляются автоматически. После исправления нужно снова добавить файлы в git:

```bash
git add .
git commit
```

### Пропустить проверки (крайний случай)

```bash
git commit --no-verify
```

⚠️ **Не рекомендуется** пропускать проверки без веской причины.
